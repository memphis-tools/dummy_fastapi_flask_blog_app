{% extends "base.html" %}

{% block title %}INDEX{% endblock title %}

{% block content %}
<div class="container">
    <div class="section_intro"></div>
    <h1>DUMMY BLOG</h1>
    <div class="d-flex flex-column m-5">
        <p>Blog perso dédié à l'apprentissage, la répétition, présenter des travaux.</p>
        <p>Mise en place d'une application web en Python sur un système Linux.</p>
        <p>Le focus est mis sur les techniques et technologies à employer.</p>
        <p>On a d'un côté une micro application interractive autour de lectures: le jeu de données correspond à mes lectures persos. Le visiteur peut utiliser un navigateur, ou faire des appels "API REST".</p>
        <p>De l'autre côté vous retrouvez une présentation de mon lab qui fait appel à <a href="https://www.proxmox.com/en/">Proxmox</a>.</p>
        <p>Usage du <a href="https://docs.docker.com/compose/" target="_blank">Docker Compose</a> afin de servir Nginx, Flask, FastAPI en frontend, appuyé sur Postgresql en backend.</p>
        <p>Usage de <a href="https://www.hashicorp.com/products/vault" target="_blank">Hashicorp Vault</a> pour ne pas stocker certaines "variables sensibles" sur les dépôts git. Exemple la SECRET_KEY de Flask et FastAPI.</p>
        <p>Noter que le dépôt Github est un mirroir du dépôt <a href="https://gitlab.com/memphis-tools/dummy_fastapi_flask_blog_app" target="_blank">Gitlab</a>.</p>
        <p>Une chaine ci-cd est en place: tests, build, et publication si branche master. <a href="https://hub.docker.com/r/memphistools/public_repo" target="_blank">Dépôt Docker Hub public</a>.</p>
        <p>La machine virtuelle a été créée chez <a href="https://www.digitalocean.com/?refcode=4f541e02cfe5&utm_campaign=Referral_Invite&utm_medium=Referral_Program&utm_source=badge" target="_blank">DigitalOcean</a>.</p>
        <p>Le provisionnement est effectué avec <a href="https://www.terraform.io/" target="_blank">Hashicorp Terraform</a></p>
        <p>Le domaine a été réservé sur <a href="https://www.namecheap.com/" target="_blank">NameCheap</a>.</p>
        <p>Usage de <a href="https://betterstack.com/logs" target="_blank">Betterstack</a> pour adresser des logs.</p>
    </div>
    <hr>
    <h1>DUMMY BLOG - LES LIVRES</h1>
    <div class="home-books-container">
      {% for book in books %}
      <div class="post-preview">
        <p class="post-title m-0">{{ book.title }}</p>
        <p class="post-meta m-0">
          Publié par <a href="{{ url_for('user_books', user_id=book.user_id) }}">{{ book.user_id|format_user() }}</a> le {{ book.publication_date|format_datetime() }}
        </p>
        <p>
            <a class="about-book" href="{{ url_for('book', book_id=book.id) }}">A propos du livre</a>
        </p>
        <div class="book-image d-flex flex-column">
            <img src="{{ url_for('static', filename=book.book_picture_name) }}" align="middle" />
            <legend>Auteur: {{ book.author }}</legend>
            <div class="counters">
                <legend>Commentaires: {{ book.nb_comments }}</legend>
                <legend>Favoris: {{ book.nb_starred }}</legend>
            </div>
        </div>
      </div>
      <hr />
      {% endfor %}
    </div>
    <div class="d-flex flex-column align-items-center justify-content-center mb-4 mt-1">
      {% if books|length > 0 %}
          <a class="btn btn-primary text-uppercase w-15" href="{{ url_for('books') }}">TOUS LES LIVRES</a>
      {% else %}
          <p>Aucuns livres pour le moment.</p>
          <a class="btn btn-primary text-uppercase" href="{{ url_for('add_book') }}">AJOUTER UN LIVRE</a>
      {% endif %}
    </div>
</div>
{% endblock content %}
